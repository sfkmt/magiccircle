# /mc:spec-design

技術設計文書を作成します。

## 実行内容

1. 承認済み要件定義書を基に技術設計を作成
2. アーキテクチャ、データモデル、インターフェースを定義
3. design.mdファイルに保存

## 使用方法

```bash
/mc:spec-design [feature-name]
```

## 引数

- `feature-name`: 対象機能の名前（省略時は最新の要件承認済み仕様書）

## プロンプト

AIアシスタントへの指示：

1. 前提条件の確認：
   ```bash
   # spec.jsonで要件フェーズが承認済みか確認
   cat .mc/specs/[feature-name]/spec.json
   # 要件定義書を読み込み
   cat .mc/specs/[feature-name]/requirements.md
   ```

2. プロジェクトのコンテキストを理解：
   - ステアリング文書から技術方針を確認
   - 既存のコードベースの構造を調査
   - 使用されている技術スタックを把握

3. 以下の構造でdesign.mdを生成：

```markdown
# [Feature Name] 技術設計書

## 概要
[技術的な実装アプローチの要約]

## アーキテクチャ
### システム構成図
```mermaid
[構成図]
```

### コンポーネント設計
- **[コンポーネント名]**
  - 責務: [責務の説明]
  - インターフェース: [インターフェースの説明]

## データモデル
### エンティティ定義
```typescript
// または適切な言語での型定義
interface [EntityName] {
  id: string;
  // ...
}
```

### データフロー
```mermaid
[データフロー図]
```

## API設計
### エンドポイント
| メソッド | パス | 説明 | リクエスト | レスポンス |
|----------|------|------|------------|------------|
| POST | /api/[path] | [説明] | [型] | [型] |

### エラーハンドリング
| エラーコード | 説明 | 対処法 |
|--------------|------|--------|
| [CODE] | [説明] | [対処法] |

## 実装詳細
### 使用する技術・ライブラリ
- [技術/ライブラリ]: [用途]

### ディレクトリ構造
```
src/
├── [構造]
```

### 主要なクラス/関数
- `[名前]`: [説明]

## セキュリティ考慮事項
- [考慮事項1]
- [考慮事項2]

## パフォーマンス最適化
- [最適化1]
- [最適化2]

## テスト戦略
### ユニットテスト
- [テスト対象と方法]

### 統合テスト
- [テスト対象と方法]

## 移行計画
[既存システムからの移行が必要な場合]

## 技術的リスク
| リスク | 影響度 | 対策 |
|--------|--------|------|
| [リスク] | 高/中/低 | [対策] |

## 依存関係
- [外部サービス/ライブラリ]: [バージョン]

## 作成日
[YYYY-MM-DD]

## 最終更新日
[YYYY-MM-DD]
```

4. 生成後、ユーザーに確認を促し、承認の準備ができたら`/mc:spec-approve design`を案内。

注意事項：
- 要件定義書のすべての要件をカバーする
- 既存のコードベースとの整合性を保つ
- 実装可能で現実的な設計にする
- セキュリティとパフォーマンスを考慮する