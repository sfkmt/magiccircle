# æ®µéšçš„å“è³ªã‚²ãƒ¼ãƒˆï¼ˆProgressive Quality Gatesï¼‰

## æ¦‚è¦
å„é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºã§æº€ãŸã™ã¹ãå“è³ªåŸºæº–ã‚’å®šç¾©ã—ã€æ®µéšçš„ã«å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚

## ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥å“è³ªã‚²ãƒ¼ãƒˆ

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆFoundationï¼‰
**ç›®æ¨™**: æœ€ä½é™ã®ãƒ“ãƒ«ãƒ‰å¯èƒ½æ€§ã‚’ç¢ºä¿

```yaml
quality_gates:
  phase1:
    - typescript_build: "tsc --noEmit ãŒæˆåŠŸ"
    - basic_lint: "eslint . --max-warnings 100"
    - dependencies: "npm install ãŒæˆåŠŸ"
    - structure: "å¿…è¦ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒå­˜åœ¨"
```

### Phase 2: å‹å®‰å…¨æ€§ï¼ˆType Safetyï¼‰
**ç›®æ¨™**: å‹ã‚¨ãƒ©ãƒ¼ã‚¼ãƒ­ã‚’é”æˆ

```yaml
quality_gates:
  phase2:
    - strict_types: "tsconfig.json ã§ strict: true"
    - no_any: "å‹å®šç¾©ã« any ã‚’ä½¿ç”¨ã—ãªã„"
    - schema_types: "DB ã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰å‹ã‚’è‡ªå‹•ç”Ÿæˆ"
    - api_contracts: "OpenAPI/GraphQL ã‚¹ã‚­ãƒ¼ãƒå®šç¾©"
```

### Phase 3: ãƒ†ã‚¹ãƒˆå¯èƒ½æ€§ï¼ˆTestabilityï¼‰
**ç›®æ¨™**: ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š

```yaml
quality_gates:
  phase3:
    - unit_tests: "å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ãƒ†ã‚¹ãƒˆå­˜åœ¨"
    - coverage: "ã‚«ãƒãƒ¬ãƒƒã‚¸ 80% ä»¥ä¸Š"
    - integration: "E2Eãƒ†ã‚¹ãƒˆã®å®Ÿè£…"
    - mocks: "å‹å®‰å…¨ãªãƒ¢ãƒƒã‚¯ã®ä½¿ç”¨"
```

### Phase 4: æœ¬ç•ªå“è³ªï¼ˆProduction Readyï¼‰
**ç›®æ¨™**: æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½

```yaml
quality_gates:
  phase4:
    - performance: "ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  < 200ms"
    - security: "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»ãƒ‘ã‚¹"
    - monitoring: "ãƒ­ã‚°ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹å®Ÿè£…"
    - documentation: "APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œå‚™"
```

## å®Ÿè£…ã‚¿ã‚¹ã‚¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
### T00X: [ã‚¿ã‚¹ã‚¯å]

#### å®Ÿè£…å†…å®¹
- [ ] æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] å‹å®šç¾©ã®ä½œæˆ/æ›´æ–°
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ä½œæˆ

#### å“è³ªã‚²ãƒ¼ãƒˆï¼ˆPhase Xï¼‰
- [ ] TypeScriptãƒ“ãƒ«ãƒ‰æˆåŠŸ `npm run build`
- [ ] å‹ãƒã‚§ãƒƒã‚¯é€šé `npm run type-check`
- [ ] Lintã‚¨ãƒ©ãƒ¼ãªã— `npm run lint`
- [ ] ãƒ†ã‚¹ãƒˆé€šé `npm test`

#### å®Œäº†æ¡ä»¶
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰¿èª
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³é€šé
- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
```

## è‡ªå‹•ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```bash
#!/bin/bash
# .mc/scripts/check-quality-gate.sh

PHASE=${1:-1}

echo "ğŸ¯ Phase $PHASE ã®å“è³ªã‚²ãƒ¼ãƒˆãƒã‚§ãƒƒã‚¯"

case $PHASE in
  1)
    npm run build || exit 1
    npm run lint -- --max-warnings 100 || exit 1
    ;;
  2)
    npm run type-check || exit 1
    # anyä½¿ç”¨ã®ãƒã‚§ãƒƒã‚¯
    if grep -r "any" --include="*.ts" --include="*.tsx" src/; then
      echo "âŒ 'any' å‹ã®ä½¿ç”¨ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ"
      exit 1
    fi
    ;;
  3)
    npm test -- --coverage || exit 1
    # ã‚«ãƒãƒ¬ãƒƒã‚¸é–¾å€¤ã®ãƒã‚§ãƒƒã‚¯
    ;;
  4)
    npm run build:prod || exit 1
    npm run security-check || exit 1
    ;;
esac

echo "âœ… Phase $PHASE ã®å“è³ªã‚²ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼"
```

## æ®µéšçš„å°å…¥æˆ¦ç•¥

1. **æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®é©ç”¨**
   - Phase 1 ã‹ã‚‰é–‹å§‹
   - æŠ€è¡“çš„è² å‚µã‚’æ®µéšçš„ã«è§£æ¶ˆ
   - å„Phaseã‚¯ãƒªã‚¢å¾Œã«æ¬¡ã¸é€²ã‚€

2. **æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®é©ç”¨**
   - Phase 2 ã‹ã‚‰é–‹å§‹ï¼ˆå‹å®‰å…¨æ€§é‡è¦–ï¼‰
   - æœ€åˆã‹ã‚‰ strict ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹åŒ–
   - ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

3. **ãƒãƒ¼ãƒ å…¨ä½“ã§ã®é‹ç”¨**
   - PRãƒãƒ¼ã‚¸æ¡ä»¶ã«å“è³ªã‚²ãƒ¼ãƒˆã‚’è¨­å®š
   - å®šæœŸçš„ãªå“è³ªãƒ¬ãƒ“ãƒ¥ãƒ¼ä¼šã®å®Ÿæ–½
   - æˆåŠŸãƒ‘ã‚¿ãƒ¼ãƒ³ã®å…±æœ‰ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–